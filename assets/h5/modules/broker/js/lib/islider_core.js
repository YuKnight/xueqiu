!function(){var t,e;t=function(){var t=function(t){if(!t.dom)throw new Error("dom element can not be empty!");if(!t.data||!t.data.length)throw new Error("data must be an array and must have more than one element!");this._opts=t,this._setting(),this._renderHTML(),this._bindHandler()};return t.prototype._setting=function(){var t=this._opts;this.wrap=t.dom,this.data=t.data,this.type=t.type||"pic",this.isVertical=t.isVertical||!1,this.isOverspread=t.isOverspread||!1,this.duration=t.duration||2e3,this.initIndex=t.initIndex||0,this.fixPage=void 0===t.fixPage?!0:t.fixPage,(this.initIndex>this.data.length-1||this.initIndex<0)&&(this.initIndex=0),this.slideIndex=this.slideIndex||this.initIndex||0,this.axis=this.isVertical?"Y":"X",this.reverseAxis="Y"===this.axis?"X":"Y",this.width=this.wrap.clientWidth,this.height=this.wrap.clientHeight,this.ratio=this.height/this.width,this.scale=t.isVertical?this.height:this.width,this.onslide=t.onslide,this.onslidestart=t.onslidestart,this.onslideend=t.onslideend,this.onslidechange=t.onslidechange,this.isLoading=t.isLoading,this.offset=this.offset||{X:0,Y:0},this.useZoom=t.useZoom||!1,this.data.length<2?(this.isLooping=!1,this.isAutoPlay=!1):(this.isLooping=t.isLooping||!1,this.isAutoplay=t.isAutoplay||!1),"card"===t.animateType&&this.isVertical&&(this.isOverspread=!0),this.isAutoplay&&this.play(),this.useZoom&&this._initZoom(t),this.log=t.isDebug?function(t){window.console.log(t)}:function(){},this._setUpDamping(),this._setPlayWhenFocus(),this._animateFunc=t.animateType in this._animateFuncs?this._animateFuncs[t.animateType]:this._animateFuncs["default"]},t.prototype._setPlayWhenFocus=function(){window.addEventListener("focus",this,!1),window.addEventListener("blur",this,!1)},t.prototype._animateFuncs={"default":function(t,e,i,s,n){t.style.webkitTransform="translateZ(0) translate"+e+"("+(n+i*(s-1))+"px)"}},t.prototype._setUpDamping=function(){var t=this.scale>>1,e=t>>1,i=e>>2;this._damping=function(s){var n,a=Math.abs(s);return n=t>a?a>>1:t+e>a?e+(a-t>>2):e+i+(a-t-e>>3),s>0?n:-n}},t.prototype._renderItem=function(t,e){var i,s,n=this.data.length,a=this,h=function(){s=i.height/i.width>a.ratio?'<img height="'+a.height+'" src="'+i.content+'">':'<img width="'+a.width+'" src="'+i.content+'">',t.innerHTML=s};if(i=this.isLooping?0>e?this.data[n+e]:e>n-1?this.data[e-n]:this.data[e]:this.data[e]||{empty:!0},i.empty)return t.innerHTML="",void(t.style.background="");if("pic"===this.type)if(this.isOverspread)t.style.background="url("+i.content+") 50% 50% no-repeat",t.style.backgroundSize="cover";else if(i.height&i.width)h();else{var o=new Image;o.src=i.content,o.onload=function(){i.height=o.height,i.width=o.width,h()}}else"dom"===this.type&&(t.innerHTML=i.content)},t.prototype._renderHTML=function(){this.outer&&(this.outer.innerHTML="");var t=this.outer||document.createElement("ul");if(t.className="islider-outer",t.style.cssText="height:"+this.height+"px;width:"+this.width+"px;margin:0;padding:0;list-style:none;","pic"===this.type&&!this.loader&&this.isLoading){var e=document.createElement("div");e.className="islider-loader",this.loader=e,this.wrap.appendChild(e)}this.els=[];for(var i=0;3>i;i++){var s=document.createElement("li");s.className="dom"===this.type?"islider-dom":"islider-pic",s.style.cssText="height:"+this.height+"px;width:"+this.width+"px;",this.els.push(s),this._animateFunc(s,this.axis,this.scale,i,0),!this.isVertical||"rotate"!==this._opts.animateType&&"flip"!==this._opts.animateType?this._renderItem(s,i-1+this.slideIndex):this._renderItem(s,1-i+this.slideIndex),t.appendChild(s)}this._initLoadImg(),this.outer||(this.outer=t,this.wrap.appendChild(t))},t.prototype._preloadImg=function(t){var e=this.data.length,i=t,s=this,n=function(t){if(t>-1&&!s.data[t].loaded){var e=new Image;e.src=s.data[t].content,e.onload=function(){s.data[t].width=e.width,s.data[t].height=e.height},s.data[t].loaded=1}};if("dom"!==s.type&&e>3){var a=i+2>e-1?(i+2)%e:i+2,h=0>i-2?e-2+i:i-2;n(a),n(h)}},t.prototype._initLoadImg=function(){var t=this.data,e=t.length,i=this.slideIndex,s=this;if("dom"!==this.type&&e>3){var n=i+2>e?(i+1)%e:i+1,a=0>i-1?e-1+i:i-1;t[i].loaded=1,t[n].loaded=1,s.isLooping&&(t[a].loaded=1),setTimeout(function(){s._preloadImg(i)},200)}},t.prototype.slideTo=function(t){var e=this.data,i=this.els,s=t,n=t-this.slideIndex;if(Math.abs(n)>1){var a=n>0?this.els[2]:this.els[0];this._renderItem(a,s)}this._preloadImg(s),e[s]?this.slideIndex=s:this.isLooping?this.slideIndex=n>0?0:e.length-1:(this.slideIndex=this.slideIndex,n=0),this.log("pic idx:"+this.slideIndex);var h;!this.isVertical||"rotate"!==this._opts.animateType&&"flip"!==this._opts.animateType?n>0?(h=i.shift(),i.push(h)):0>n&&(h=i.pop(),i.unshift(h)):n>0?(h=i.pop(),i.unshift(h)):0>n&&(h=i.shift(),i.push(h)),0!==n&&(Math.abs(n)>1?(this._renderItem(i[0],s-1),this._renderItem(i[2],s+1)):1===Math.abs(n)&&this._renderItem(h,s+n),h.style.webkitTransition="none",h.style.visibility="hidden",setTimeout(function(){h.style.visibility="visible"},200),this.onslidechange&&this.onslidechange(this.slideIndex),this.dotchange&&this.dotchange());for(var o=0;3>o;o++)i[o]!==h&&(i[o].style.webkitTransition="all .3s ease"),this._animateFunc(i[o],this.axis,this.scale,o,0);this.isAutoplay&&!this.isLooping&&this.slideIndex===e.length-1&&this.pause()},t.prototype._device=function(){var t=!!("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),e=t?"touchstart":"mousedown",i=t?"touchmove":"mousemove",s=t?"touchend":"mouseup";return{hasTouch:t,startEvt:e,moveEvt:i,endEvt:s}},t.prototype._bindHandler=function(){var t=this.outer,e=this._device();e.hasTouch||(t.style.cursor="pointer",t.ondragstart=function(t){return t?!1:!0}),t.addEventListener(e.startEvt,this),t.addEventListener(e.moveEvt,this),t.addEventListener(e.endEvt,this),window.addEventListener("orientationchange",this)},t.prototype.bind=t.prototype.delegate=function(t,e,i){function s(t){for(var s=window.event?window.event:t,n=s.target,a=document.querySelectorAll(e),h=0;h<a.length;h++)if(n===a[h]){i.call(n);break}}this.wrap.addEventListener(t,s,!1)},t.prototype.destroy=function(){var t=this.outer,e=this._device();t.removeEventListener(e.startEvt,this),t.removeEventListener(e.moveEvt,this),t.removeEventListener(e.endEvt,this),window.removeEventListener("orientationchange",this),window.removeEventListener("focus",this),window.removeEventListener("blur",this),this.wrap.innerHTML=""},t.prototype.handleEvent=function(t){var e=this._device();switch(t.type){case e.startEvt:this.startHandler(t);break;case e.moveEvt:this.moveHandler(t);break;case e.endEvt:this.endHandler(t);break;case"touchcancel":this.endHandler(t);break;case"orientationchange":this.orientationchangeHandler();break;case"focus":this.isAutoplay&&this.play();break;case"blur":this.pause()}},t.prototype.startHandler=function(t){if(this.fixPage){var e=t.target;"SELECT"!==e.tagName&&"INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName&&t.preventDefault()}var i=this._device();this.isMoving=!0,this.pause(),this.onslidestart&&this.onslidestart(),this.log("Event: beforeslide"),this.startTime=(new Date).getTime(),this.startX=i.hasTouch?t.targetTouches[0].pageX:t.pageX,this.startY=i.hasTouch?t.targetTouches[0].pageY:t.pageY,this._startHandler&&this._startHandler(t)},t.prototype.moveHandler=function(t){if(this.isMoving){var e=this._device(),i=this.data.length,s=this.axis,n=this.reverseAxis,a={X:e.hasTouch?t.targetTouches[0].pageX-this.startX:t.pageX-this.startX,Y:e.hasTouch?t.targetTouches[0].pageY-this.startY:t.pageY-this.startY},h=this._moveHandler?this._moveHandler(t):!1;if(!h&&Math.abs(a[s])-Math.abs(a[n])>10){t.preventDefault(),this.onslide&&this.onslide(a[s]),this.log("Event: onslide"),this.isLooping||(a[s]>0&&0===this.slideIndex||a[s]<0&&this.slideIndex===i-1)&&(a[s]=this._damping(a[s]));for(var o=0;3>o;o++){var r=this.els[o];r.style.webkitTransition="all 0s",this._animateFunc(r,s,this.scale,o,a[s])}}this.offset=a}},t.prototype.endHandler=function(t){this.isMoving=!1;var e=this.offset,i=this.axis,s=this.scale/2,n=(new Date).getTime();s=n-this.startTime>300?s:14;var a=this._endHandler?this._endHandler(t):!1,h=Math.abs(e[i]),o=Math.abs(e[this.reverseAxis]),r=function(t){if("A"===t.tagName){if(t.href)return window.location.href=t.href,!1}else{if("islider-dom"===t.className)return!1;r(t.parentNode)}};!a&&e[i]>=s&&h>o?this.slideTo(this.slideIndex-1):!a&&e[i]<-s&&h>o?this.slideTo(this.slideIndex+1):a||this.slideTo(this.slideIndex),Math.abs(this.offset.X)<10&&Math.abs(this.offset.Y)<10&&(this.tapEvt=document.createEvent("Event"),this.tapEvt.initEvent("tap",!0,!0),this.fixPage&&"dom"===this.type&&r(t.target),t.target.dispatchEvent(this.tapEvt)||t.preventDefault()),this.offset.X=this.offset.Y=0,this.isAutoplay&&this.play(),this.onslideend&&this.onslideend(this.slideIndex),this.log("Event: afterslide")},t.prototype.orientationchangeHandler=function(){var t=this;setTimeout(function(){t.reset(),t.log("Event: orientationchange")},100)},t.prototype.reset=function(){this.pause(),this._setting(),this._renderHTML(),this.isAutoplay&&this.play()},t.prototype.loadData=function(t,e){this.pause(),this.slideIndex=e||0,this.data=t,this._renderHTML(),this.isAutoplay&&this.play()},t.prototype.play=function(){var t=this,e=this.duration;clearInterval(this.autoPlayTimer),this.autoPlayTimer=setInterval(function(){t.slideTo(t.slideIndex+1)},e)},t.prototype.pause=function(){clearInterval(this.autoPlayTimer)},t.prototype.extend=function(e,i){i||(i=t.prototype),Object.keys(e).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})},t}(),e=void 0,window.iSlider=t}();