define(function(require,exports,module){var e=require("template/order/order-state-list.js"),t=Util.parseParams(),r=t.orders?$.parseJSON(decodeURIComponent(t.orders)):{};module.exports={init:function(o){if(o)t.oid&&$(".oid").length?$(".oid").text(t.oid):(t.count||r.length)&&$(".state-desc p").html("感谢使用雪球实盘交易功能");else{var n=e({data:{list:r}});$(".order-state").html(n)}t.coupon&&(xqBridge.trackEvent("trade_order_quan"),$(".state-desc").css({paddingBottom:0}),-1!==t.couponType.search("交易体验券")&&$(".coupon-text").text("委托单成交后，预计"+t.coupon+"元现金将返现到钱包余额"),-1!==t.couponType.search("美股佣金券")&&$(".coupon-text").text("委托单成交后，预计6.5元现金将返现到钱包余额"),-1!==t.couponType.search("亏损抵用券")&&$(".coupon-text").text("委托成交后，视收盘盈亏情况确定是否返现"+t.coupon+"元"),$(".coupon-success").show()),this.bindEvent()},bindEvent:function(){$(".state-desc").on("click","a",function(){return xqBridge.redirect({url:"/cube/order-state"+location.search,type:"PUSH"}),!1}),$(".broker-order").on("click",function(){xqBridge.SNBTrackEvent({page:1507,event:1,info:{}});var e="/broker/orders";"PAMID"==t.tid&&Util.appVersion()>=7.7&&(e="/broker/trade-history"),t.tid&&(e+="?tid="+t.tid),xqBridge.redirect({url:e,type:"PUSH"})}),$(".back-cube").on("click",function(){xqBridge.redirect({type:"POP"})}),$(".order-share").on("click",function(){xqBridge.SNBTrackEvent({page:1507,event:2,info:{}});var e=t.count||r.length,o="";if(e)o="我通过雪球#一键清仓#卖出"+e+"只股票。股市无常，我想静静。";else{var n="BUY"===t.action?"买入":"卖出",i="$"+t.sname+"("+t.symbol+")$",c=t.price;if("IB"===t.tid){c+="";var s=c.split(".");s[1]?1==s[1].length&&(c+="0"):c+=".00"}o="我刚刚在#雪球实盘交易#委托"+n+i+"，委托"+n+"价"+c+"。","MKT"==t.otype&&(o="我刚刚在#雪球实盘交易#市价委托"+n+i+"。"),t.newStock&&(o=" 我刚刚在#雪球实盘交易#申购了新股"+i+"，希望能中签~")}xqBridge.confirm({title:"分享给球友",message:o,success:function(){xqBridge.showLoading();var e={module_id:"yO51t0AH4X",status:o};t.symbol&&(e.card_type="stock",e.card_param=t.symbol),xqBridge.request({url:"/statuses/update.json",type:"POST",data:e,success:function(){Util.showError("分享成功!"),xqBridge.trackEvent("trade_orderShare")},error:function(){Util.showError("分享出错")},complete:function(){xqBridge.hideLoading()}})},cancel:function(){}})})}}});