$(function(){function i(i){var n,t=moment(parseInt(i.created_at)).format("YYYY-MM-DD HH:mm"),o=(i.snow_money/100).formatMoney(2,".",","),o=parseFloat((i.snow_money-i.pre_snow_money)/100),e=o.formatMoney(2,".",",");n=o>0?'<div class="amount-negative">+'+e+"</div>":'<div class="amount-negative">'+e+"</div>";var a='<li data-id="'+i.id+'"><div class="arrow-left"><p class="bill-name">'+i.name+'</p><p class="bill-createdAt">'+t+"</p></div>"+n+"</div>";return a}function n(n){var t=n.list,o="";return 0==t.length?void(1==e&&$(".no-data").hide().show()):(_.each(t,function(n){var t=moment(parseInt(n.created_at)).format("YYYY-MM");l!=t&&(o+='<li class="month">'+t+"</li>"),o+=i(n),r[n.id]=n,l=t}),$(".bill-list").append(o),void(e>=n.maxPage?(a=!1,$(".loading").hide()):1==e&&$(".loading").show()))}function t(){e++,xqBridge.request({url:"/tc/snowpay/bill/list.json",type:"GET",data:{page:e,count:20},success:function(i){i&&n(i)},error:function(i){Util.showError(i.error_description)},complete:function(){}})}function o(){$(window).scrollTop()+$(window).height()>=$(document).height()&&a&&t()}var e=0,a=!0,r={},l="";$(".bill-list").on("click","li",function(){var i=$(this).data("id"),n=r[i];return xqBridge.redirect({url:"/wallet/bill-detail?"+$.param(n),type:"PUSH"}),!1}),$(window).bind("scroll",function(){o()}),t()});